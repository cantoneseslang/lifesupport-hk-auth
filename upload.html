<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ›¸é¡ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ - LIFESUPPORT(HK)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .logo-img {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            display: block;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9rem;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .section-title {
            font-size: 1.3rem;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }
        
        select, input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        select:focus, input[type="file"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .upload-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        
        .upload-btn:hover {
            background: #5568d3;
        }
        
        .upload-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .result-box {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 2px solid #667eea;
            display: none;
        }
        
        .result-box.show {
            display: block;
        }
        
        .result-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .result-item {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .result-label {
            font-weight: bold;
            color: #666;
        }
        
        .result-value {
            color: #333;
            margin-left: 10px;
        }
        
        .success-message {
            color: #28a745;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .error-message {
            color: #dc3545;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .company-info {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            text-align: center;
            font-size: 0.9rem;
            color: #999;
        }
        
        .note {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #856404;
        }
        
        .note-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 10px;
            transition: border-color 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .auto-fill-section {
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .auto-fill-title {
            color: #28a745;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .survey-link {
            background: #667eea;
            color: white;
            padding: 15px 30px;
            border-radius: 8px;
            text-decoration: none;
            display: inline-block;
            margin-top: 15px;
            transition: background 0.3s;
        }
        
        .survey-link:hover {
            background: #5568d3;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="lifesupport-logo.png" alt="LIFESUPPORT(HK)LIMITED" class="logo-img">
        <h1>LIFESUPPORT(HK)LIMITED</h1>
        <p class="subtitle">æ›¸é¡ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚·ã‚¹ãƒ†ãƒ </p>
        
        <!-- æœ¬äººç¢ºèªæ›¸é¡ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="section">
            <h2 class="section-title">ğŸ“„ æœ¬äººç¢ºèªæ›¸é¡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>
            
            <div class="note">
                <div class="note-title">âš ï¸ é‡è¦ãªãŠçŸ¥ã‚‰ã›</div>
                <p>ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€OCRï¼ˆå…‰å­¦æ–‡å­—èªè­˜ï¼‰ã«ã‚ˆã‚Šè‡ªå‹•çš„ã«åå‰ãƒ»ä½æ‰€ãƒ»éƒµä¾¿ç•ªå·ãŒæŠ½å‡ºã•ã‚Œã¾ã™ã€‚æŠ½å‡ºã•ã‚ŒãŸæƒ…å ±ã¯ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«è‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚</p>
            </div>
            
            <div class="form-group">
                <label for="identityDocType">æ›¸é¡ã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„ *</label>
                <select id="identityDocType" required>
                    <option value="">-- é¸æŠã—ã¦ãã ã•ã„ --</option>
                    <option value="ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ">ãƒ‘ã‚¹ãƒãƒ¼ãƒˆ</option>
                    <option value="ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ä½æ‰€è¨˜è¼‰é¢">ãƒã‚¤ãƒŠãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ä½æ‰€è¨˜è¼‰é¢</option>
                    <option value="å›½éš›é‹è»¢å…è¨±è¨¼">å›½éš›é‹è»¢å…è¨±è¨¼</option>
                    <option value="ä½æ°‘ç¥¨">ä½æ°‘ç¥¨</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="identityFile">ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ *</label>
                <input type="file" id="identityFile" accept="image/*" required>
            </div>
            
            <button class="upload-btn" onclick="uploadIdentityDocument()">
                æœ¬äººç¢ºèªæ›¸é¡ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
            </button>
            
            <div class="loading" id="identityLoading">
                <div class="spinner"></div>
                <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­... OCRå‡¦ç†ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™</p>
            </div>
            
            <div class="result-box" id="identityResult">
                <div class="result-title">âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†</div>
                <div id="identityResultContent"></div>
            </div>
            
            <!-- OCRçµæœã®è‡ªå‹•å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="auto-fill-section" id="autoFillSection" style="display: none;">
                <div class="auto-fill-title">ğŸ“ OCRçµæœã®ç¢ºèªã¨ä¿®æ­£</div>
                <p>ä»¥ä¸‹ã®æƒ…å ±ãŒOCRã§æŠ½å‡ºã•ã‚Œã¾ã—ãŸã€‚å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚</p>
                
                <div class="form-group">
                    <label for="extractedName">ãŠåå‰ *</label>
                    <input type="text" id="extractedName" class="form-input" placeholder="OCRã§æŠ½å‡ºã•ã‚ŒãŸåå‰">
                </div>
                
                <div class="form-group">
                    <label for="extractedPostalCode">éƒµä¾¿ç•ªå· *</label>
                    <input type="text" id="extractedPostalCode" class="form-input" placeholder="OCRã§æŠ½å‡ºã•ã‚ŒãŸéƒµä¾¿ç•ªå·">
                </div>
                
                <div class="form-group">
                    <label for="extractedAddress">ä½æ‰€ *</label>
                    <input type="text" id="extractedAddress" class="form-input" placeholder="OCRã§æŠ½å‡ºã•ã‚ŒãŸä½æ‰€">
                </div>
                
                <button class="upload-btn" onclick="openSurveyWithAutoFill()">
                    ğŸ“‹ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãï¼ˆè‡ªå‹•å…¥åŠ›ï¼‰
                </button>
            </div>
        </div>
        
        <!-- äº‹æ¥­æ´»å‹•è¨¼æ˜æ›¸é¡ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="section">
            <h2 class="section-title">ğŸ¢ äº‹æ¥­æ´»å‹•è¨¼æ˜æ›¸é¡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>
            
            <div class="note">
                <div class="note-title">ğŸ“ æå‡ºæ›¸é¡ã«ã¤ã„ã¦</div>
                <p>ä¼šç¤¾æ¡ˆå†…ã€ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€è³ƒè²¸å¥‘ç´„æ›¸ãªã©ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚</p>
            </div>
            
            <div class="form-group">
                <label for="businessDocType">æ›¸é¡ã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„ *</label>
                <select id="businessDocType" required>
                    <option value="">-- é¸æŠã—ã¦ãã ã•ã„ --</option>
                    <option value="ä¼šç¤¾æ¡ˆå†…">ä¼šç¤¾æ¡ˆå†…</option>
                    <option value="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸">ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸</option>
                    <option value="è³ƒè²¸å¥‘ç´„æ›¸">è³ƒè²¸å¥‘ç´„æ›¸</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="businessFile">ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ *</label>
                <input type="file" id="businessFile" accept="image/*" required>
            </div>
            
            <button class="upload-btn" onclick="uploadBusinessDocument()">
                äº‹æ¥­æ´»å‹•è¨¼æ˜æ›¸é¡ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
            </button>
            
            <div class="loading" id="businessLoading">
                <div class="spinner"></div>
                <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...</p>
            </div>
            
            <div class="result-box" id="businessResult">
                <div class="result-title">âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†</div>
                <div id="businessResultContent"></div>
            </div>
        </div>
        
        <div class="company-info">
            <strong>LIFESUPPORT(HK)LIMITED</strong><br>
            No 163 Pan Chung, Tai Po, N.T., HK<br>
            Tel: (852)52263586<br>
            Website: <a href="https://lshk-ai-service.studio.site/" style="color: #667eea;">lshk-ai-service.studio.site</a>
        </div>
    </div>
    
    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzvOHWc3BbVRJMOLhxMXEWDG3zZNT9iJBdLaCgtv-4Fsxq7v03HOGeFfDFTrVG1Ow-y/exec'; // Google Apps Scriptã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³URL
        const SURVEY_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSfOParTZ0EJElORcS6xxqm_KfQp5Xz4_-pZ0X1_s9zc8PmRoA/viewform'; // ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®URLï¼ˆä¿®å¾©æ¸ˆã¿ï¼‰
        
        async function uploadIdentityDocument() {
            const docType = document.getElementById('identityDocType').value;
            const fileInput = document.getElementById('identityFile');
            const file = fileInput.files[0];
            
            if (!docType) {
                alert('æ›¸é¡ã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            if (!file) {
                alert('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            document.getElementById('identityLoading').classList.add('show');
            document.getElementById('identityResult').classList.remove('show');
            
            try {
                const formData = new FormData();
                formData.append('uploadType', 'identity');
                formData.append('documentType', docType);
                formData.append('file', file);
                
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
                document.getElementById('identityLoading').classList.remove('show');
                
                if (result.success) {
                    // çµæœè¡¨ç¤º
                    let resultHTML = `
                        <div class="success-message">âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸ</div>
                        <div class="result-item">
                            <span class="result-label">ãƒ•ã‚¡ã‚¤ãƒ«å:</span>
                            <span class="result-value">${result.fileName}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ãƒ•ã‚¡ã‚¤ãƒ«URL:</span>
                            <span class="result-value"><a href="${result.fileUrl}" target="_blank">ç¢ºèªã™ã‚‹</a></span>
                        </div>
                    `;
                    
                    if (result.ocrResult) {
                        resultHTML += `
                            <div class="result-item">
                                <span class="result-label">OCRæŠ½å‡ºçµæœ:</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ãŠåå‰:</span>
                                <span class="result-value">${result.ocrResult.name || 'æŠ½å‡ºã§ãã¾ã›ã‚“ã§ã—ãŸ'}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">éƒµä¾¿ç•ªå·:</span>
                                <span class="result-value">${result.ocrResult.postalCode || 'æŠ½å‡ºã§ãã¾ã›ã‚“ã§ã—ãŸ'}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ä½æ‰€:</span>
                                <span class="result-value">${result.ocrResult.address || 'æŠ½å‡ºã§ãã¾ã›ã‚“ã§ã—ãŸ'}</span>
                            </div>
                            <div class="note" style="margin-top: 15px;">
                                <p>â€» ã“ã‚Œã‚‰ã®æƒ…å ±ã¯ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«è‡ªå‹•å…¥åŠ›ã•ã‚Œã¾ã™ã€‚å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚</p>
                            </div>
                        `;
                        
                        // OCRçµæœã‚’è‡ªå‹•å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨­å®š
                        document.getElementById('extractedName').value = result.ocrResult.name || '';
                        document.getElementById('extractedPostalCode').value = result.ocrResult.postalCode || '';
                        document.getElementById('extractedAddress').value = result.ocrResult.address || '';
                        
                        // è‡ªå‹•å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
                        document.getElementById('autoFillSection').style.display = 'block';
                    }
                    
                    document.getElementById('identityResultContent').innerHTML = resultHTML;
                    document.getElementById('identityResult').classList.add('show');
                } else {
                    document.getElementById('identityResultContent').innerHTML = `
                        <div class="error-message">âŒ ã‚¨ãƒ©ãƒ¼: ${result.error}</div>
                    `;
                    document.getElementById('identityResult').classList.add('show');
                }
            } catch (error) {
                document.getElementById('identityLoading').classList.remove('show');
                document.getElementById('identityResultContent').innerHTML = `
                    <div class="error-message">âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}</div>
                `;
                document.getElementById('identityResult').classList.add('show');
            }
        }
        
        async function uploadBusinessDocument() {
            const docType = document.getElementById('businessDocType').value;
            const fileInput = document.getElementById('businessFile');
            const file = fileInput.files[0];
            
            if (!docType) {
                alert('æ›¸é¡ã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            if (!file) {
                alert('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            document.getElementById('businessLoading').classList.add('show');
            document.getElementById('businessResult').classList.remove('show');
            
            try {
                const formData = new FormData();
                formData.append('uploadType', 'business');
                formData.append('documentType', docType);
                formData.append('file', file);
                
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
                document.getElementById('businessLoading').classList.remove('show');
                
                if (result.success) {
                    // çµæœè¡¨ç¤º
                    const resultHTML = `
                        <div class="success-message">âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸ</div>
                        <div class="result-item">
                            <span class="result-label">ãƒ•ã‚¡ã‚¤ãƒ«å:</span>
                            <span class="result-value">${result.fileName}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ãƒ•ã‚¡ã‚¤ãƒ«URL:</span>
                            <span class="result-value"><a href="${result.fileUrl}" target="_blank">ç¢ºèªã™ã‚‹</a></span>
                        </div>
                    `;
                    
                    document.getElementById('businessResultContent').innerHTML = resultHTML;
                    document.getElementById('businessResult').classList.add('show');
                } else {
                    document.getElementById('businessResultContent').innerHTML = `
                        <div class="error-message">âŒ ã‚¨ãƒ©ãƒ¼: ${result.error}</div>
                    `;
                    document.getElementById('businessResult').classList.add('show');
                }
            } catch (error) {
                document.getElementById('businessLoading').classList.remove('show');
                document.getElementById('businessResultContent').innerHTML = `
                    <div class="error-message">âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}</div>
                `;
                document.getElementById('businessResult').classList.add('show');
            }
        }
        
        // ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãé–¢æ•°ï¼ˆè‡ªå‹•å…¥åŠ›ä»˜ãï¼‰
        function openSurveyWithAutoFill() {
            const name = document.getElementById('extractedName').value;
            const postalCode = document.getElementById('extractedPostalCode').value;
            const address = document.getElementById('extractedAddress').value;
            
            if (!name || !postalCode || !address) {
                alert('ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            // ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®URL
            const surveyUrl = SURVEY_URL;
            
            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æƒ…å ±ã‚’æ¸¡ã™
            const params = new URLSearchParams({
                name: name,
                postalCode: postalCode,
                address: address,
                autoFill: 'true'
            });
            
            const fullUrl = `${surveyUrl}?${params.toString()}`;
            
            // æ–°ã—ã„ã‚¿ãƒ–ã§ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã
            window.open(fullUrl, '_blank');
        }
    </script>
</body>
</html>
